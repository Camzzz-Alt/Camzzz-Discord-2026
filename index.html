<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Camzzz's Discord</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="icon" href="https://i.imgur.com/ELHSqM3.png" type="image/png">
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>

  <!-- ========== AUTH SCREEN ========== -->
  <div id="authScreen">
    <div class="auth-bg-grid"></div>

    <!-- LOGIN CARD -->
    <div class="auth-card" id="loginCard">
      <div class="auth-logo">
        <img class="logo-icon-img" src="https://i.imgur.com/ELHSqM3.png" alt="Logo">
        <span>Camzzz's Discord</span>
      </div>
      <h2>Welcome back</h2>
      <p class="auth-subtitle">Sign in to continue chatting</p>
      <button id="googleSignInBtn" class="google-btn">
        <svg width="18" height="18" viewBox="0 0 18 18">
          <path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.875 2.684-6.615z"/>
          <path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332C2.438 15.983 5.482 18 9 18z"/>
          <path fill="#FBBC05" d="M3.964 10.71c-.18-.54-.282-1.117-.282-1.71s.102-1.17.282-1.71V4.958H.957C.347 6.173 0 7.548 0 9s.348 2.827.957 4.042l3.007-2.332z"/>
          <path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58z"/>
        </svg>
        Continue with Google
      </button>
      <div class="auth-divider"><span>or</span></div>
      <div class="auth-field">
        <label>Email</label>
        <input id="loginEmail" type="email" placeholder="you@example.com" autocomplete="email">
      </div>
      <div class="auth-field">
        <label>Password</label>
        <input id="loginPassword" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password">
      </div>
      <p id="loginError" class="auth-error"></p>
      <button id="loginBtn" class="auth-btn">Sign In</button>
      <p class="auth-switch">No account? <a id="showSignupBtn" href="#">Create one</a></p>
      <p id="verifyNotice" class="verify-notice" style="display:none;">
        üìß Please verify your email first. <a id="resendVerifyBtn" href="#">Resend email</a>
      </p>
    </div>

    <!-- SIGNUP CARD -->
    <div class="auth-card" id="signupCard" style="display:none;">
      <div class="auth-logo">
        <img class="logo-icon-img" src="https://i.imgur.com/ELHSqM3.png" alt="Logo">
        <span>Camzzz's Discord</span>
      </div>
      <h2>Create account</h2>
      <p class="auth-subtitle">Join the server ‚Äî it's invite-only</p>
      <button id="googleSignUpBtn" class="google-btn">
        <svg width="18" height="18" viewBox="0 0 18 18">
          <path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.875 2.684-6.615z"/>
          <path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332C2.438 15.983 5.482 18 9 18z"/>
          <path fill="#FBBC05" d="M3.964 10.71c-.18-.54-.282-1.117-.282-1.71s.102-1.17.282-1.71V4.958H.957C.347 6.173 0 7.548 0 9s.348 2.827.957 4.042l3.007-2.332z"/>
          <path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58z"/>
        </svg>
        Sign up with Google
      </button>
      <div class="auth-divider"><span>or</span></div>
      <div class="auth-field">
        <label>Username</label>
        <input id="signupUsername" type="text" placeholder="CoolUsername" maxlength="24">
        <span id="usernameCheck" class="field-hint"></span>
      </div>
      <div class="auth-field">
        <label>Email</label>
        <input id="signupEmail" type="email" placeholder="you@example.com" autocomplete="email">
      </div>
      <div class="auth-field">
        <label>Password</label>
        <input id="signupPassword" type="password" placeholder="At least 6 characters" autocomplete="new-password">
      </div>
      <p id="signupError" class="auth-error"></p>
      <button id="signupBtn" class="auth-btn">Create Account</button>
      <p class="auth-switch">Already have one? <a id="showLoginBtn" href="#">Sign in</a></p>
    </div>

    <!-- GOOGLE USERNAME PICKER -->
    <div class="auth-card" id="googleUsernameCard" style="display:none;">
      <div class="auth-logo">
        <img class="logo-icon-img" src="https://i.imgur.com/ELHSqM3.png" alt="Logo">
        <span>Camzzz's Discord</span>
      </div>
      <h2>Pick a username</h2>
      <p class="auth-subtitle">How you'll appear in chat. You can change it once per week.</p>
      <div class="auth-field">
        <label>Username</label>
        <input id="googleUsername" type="text" placeholder="CoolUsername" maxlength="24">
        <span id="googleUsernameCheck" class="field-hint"></span>
      </div>
      <p id="googleUsernameError" class="auth-error"></p>
      <button id="googleUsernameConfirmBtn" class="auth-btn">Let's go ‚Üí</button>
    </div>

    <!-- VERIFY EMAIL CARD -->
    <div class="auth-card" id="verifyCard" style="display:none;">
      <div class="auth-logo">
        <img class="logo-icon-img" src="https://i.imgur.com/ELHSqM3.png" alt="Logo">
        <span>Camzzz's Discord</span>
      </div>
      <h2>Check your email</h2>
      <p class="auth-subtitle">We sent a verification link to <strong id="verifyEmailAddr"></strong>. Click it to activate your account.</p>
      <button id="resendVerifyBtn2" class="auth-btn" style="margin-top:8px;">Resend Email</button>
      <p class="auth-switch"><a id="backToLoginBtn" href="#">‚Üê Back to sign in</a></p>
    </div>
  </div>

  <!-- ========== MOD MENU PASSWORD GATE ========== -->
  <div id="modMenuPasswordGate" style="display:none;">
    <div class="gateCard">
      <div class="gateLogo">üõ°Ô∏è Mod Access</div>
      <h2>Moderator Login</h2>
      <p class="gateSubtitle">Enter the mod password to access admin controls.</p>
      <div class="inputRow">
        <input id="modMenuPasswordInput" type="password" placeholder="Mod password" autocomplete="off">
        <button id="modMenuEnterBtn">Enter</button>
      </div>
      <p id="modMenuGateMessage" class="gateMessage"></p>
    </div>
  </div>

  <!-- ========== MOD MENU ========== -->
  <div id="modMenu" style="display:none;">
    <div class="modMenuContainer">

      <!-- Header -->
      <div class="modMenuHeader">
        <div class="modMenuHeaderLeft">
          <span class="modMenuIcon">‚öôÔ∏è</span>
          <div>
            <h2>Moderator Panel</h2>
            <p class="modMenuSubtitle">Server administration controls</p>
          </div>
        </div>
        <button id="modMenuCloseBtn">‚úï Close</button>
      </div>

      <!-- Search Bar -->
      <div class="modSearchBar">
        <span class="modSearchIcon">üîç</span>
        <input id="modSearchInput" type="text" placeholder="Search users by name or ID..." autocomplete="off">
      </div>

      <!-- Tab Bar -->
      <div class="modTabBar">
        <button class="modTab active" data-tab="users">
          <span>üë•</span> Users
          <span class="modTabBadge" id="usersTabBadge">0</span>
        </button>
        <button class="modTab" data-tab="bans">
          <span>üö´</span> Bans
          <span class="modTabBadge" id="bansTabBadge">0</span>
        </button>
        <button class="modTab" data-tab="tags">
          <span>üè∑Ô∏è</span> Tags
          <span class="modTabBadge" id="tagsTabBadge">0</span>
        </button>
        <button class="modTab" data-tab="timeouts">
          <span>‚è±Ô∏è</span> Timeouts
          <span class="modTabBadge" id="timeoutsTabBadge">0</span>
        </button>
      </div>

      <!-- TAB: USERS -->
      <div class="modTabContent active" id="tabUsers">
        <div id="allUsersList"></div>
      </div>

      <!-- TAB: BANS -->
      <div class="modTabContent" id="tabBans">
        <div class="modSectionInner">
          <label class="modLabel">Ban a User by ID</label>
          <div class="inputRow">
            <input id="banUserInput" placeholder="Enter User ID">
            <button id="banUserBtn" class="mod-action-btn danger">üö´ Ban</button>
          </div>
        </div>
        <div class="modSectionInner">
          <label class="modLabel">Currently Banned</label>
          <div id="bannedUsersList"></div>
        </div>
      </div>

      <!-- TAB: TAGS -->
      <div class="modTabContent" id="tabTags">
        <div class="modSectionInner">
          <label class="modLabel">Available Tags ‚Äî click to select</label>
          <div id="tagPalette" class="tagPalette"></div>
        </div>
        <div class="modSectionInner">
          <label class="modLabel">Apply Tag to User</label>
          <div class="inputRow">
            <input id="tagUserIdInput" placeholder="User ID">
            <input id="tagNameInput" placeholder="Tag name (or click above)" readonly>
            <button id="addTagBtn" class="mod-action-btn">‚ûï Add</button>
          </div>
          <p class="modHint">Click a tag above to auto-fill, then enter the User ID and hit Add.</p>
        </div>
        <div class="modSectionInner">
          <label class="modLabel">Tagged Users</label>
          <div id="userTagsList"></div>
        </div>
      </div>

      <!-- TAB: TIMEOUTS -->
      <div class="modTabContent" id="tabTimeouts">
        <div class="modSectionInner">
          <label class="modLabel">Timeout a User</label>
          <div class="inputRow" style="margin-bottom:12px;">
            <input id="timeoutUserIdInput" placeholder="Enter User ID">
          </div>
          <label class="modLabel">Duration</label>
          <div class="timeoutDurationGrid">
            <button class="timeoutDurBtn" data-ms="300000">5 min</button>
            <button class="timeoutDurBtn" data-ms="1800000">30 min</button>
            <button class="timeoutDurBtn" data-ms="3600000">1 hour</button>
            <button class="timeoutDurBtn" data-ms="21600000">6 hours</button>
            <button class="timeoutDurBtn" data-ms="86400000">24 hours</button>
            <button class="timeoutDurBtn" data-ms="604800000">1 week</button>
          </div>
          <button id="applyTimeoutBtn" class="mod-action-btn" style="margin-top:12px;width:100%;">‚è±Ô∏è Apply Timeout</button>
        </div>
        <div class="modSectionInner">
          <label class="modLabel">Active Timeouts</label>
          <div id="activeTimeoutsList"></div>
        </div>
      </div>

    </div>
  </div>

  <!-- ========== CONFIRM DIALOG ========== -->
  <div id="modConfirmDialog" style="display:none;">
    <div class="confirmCard">
      <div class="confirmIcon" id="confirmIcon">‚ö†Ô∏è</div>
      <h3 id="confirmTitle">Are you sure?</h3>
      <p id="confirmMessage">This action cannot be undone.</p>
      <div class="confirmBtns">
        <button id="confirmCancelBtn" class="confirmBtn cancel">Cancel</button>
        <button id="confirmOkBtn" class="confirmBtn ok">Confirm</button>
      </div>
    </div>
  </div>

  <!-- ========== AVATAR UPLOAD INPUT (hidden) ========== -->
  <input type="file" id="avatarFileInput" accept="image/*" style="display:none;">

  <!-- ========== LOADING SCREEN ========== -->
  <div id="loadingScreen" style="display:none;">
    <div class="loading-content">
      <img class="loading-logo-img" src="https://i.imgur.com/ELHSqM3.png" alt="Logo">
      <h2>Loading Chat...</h2>
      <div id="countdownContainer"><div id="countdownBar"></div></div>
      <p id="countdownText">3s</p>
    </div>
  </div>

  <!-- ========== MAIN APP ========== -->
  <div id="appContainer" style="display:none;">

    <!-- SIDEBAR -->
    <div id="sidebar">
      <div class="sidebar-top">
        <div class="sidebar-brand">
          <img class="sidebar-logo-img" src="https://i.imgur.com/ELHSqM3.png" alt="Logo">
          <span>Camzzz's Discord</span>
        </div>
      </div>
      <div class="sidebar-section">
        <div class="sidebar-section-label">CHANNELS</div>
        <button class="serverBtn" data-server="server1"><span class="channel-hash">#</span> general</button>
        <button class="serverBtn" data-server="server2"><span class="channel-hash">#</span> general-2</button>
      </div>
      <div class="sidebar-section">
        <!-- Online count -->
        <div class="sidebar-section-label">ONLINE</div>
        <div id="onlineCountDisplay" class="online-count-display">
          <span class="online-dot"></span>
          <span id="onlineCountNum">0</span> online
        </div>
      </div>
      <div class="sidebar-section">
        <div class="sidebar-section-label">APPEARANCE</div>
        <div id="colorPickerBtn"></div>
        <div id="themeColorSection"></div>
        <div id="textSizeSection"></div>
      </div>
      <div class="sidebar-user-panel">
        <!-- Clickable avatar -->
        <div class="user-avatar-wrap" id="sidebarAvatarWrap" title="Click to change profile picture">
          <div class="user-avatar" id="sidebarAvatar">?</div>
          <div class="avatar-upload-overlay">üì∑</div>
        </div>
        <div class="user-info">
          <div id="sidebarUsername" class="user-name">Loading...</div>
          <div class="user-status">‚óè Online</div>
        </div>
        <button id="logoutBtn" class="logout-btn" title="Sign out">‚èª</button>
      </div>
    </div>

    <!-- CHAT -->
    <div id="chatContainer">
      <div id="chatHeader">
        <span class="channel-hash" style="font-size:18px;">#</span>
        <span id="channelName">general</span>
        <div id="betaWarning">‚ö† Beta ‚Äî messages may lag. Click to dismiss.</div>
      </div>
      <div id="chatbox"></div>

      <!-- Typing indicator -->
      <div id="typingIndicator" class="typing-indicator" style="display:none;">
        <div class="typing-dots"><span></span><span></span><span></span></div>
        <span id="typingText"></span>
      </div>

      <!-- Reply bar -->
      <div id="replyBar" style="display:none;">
        <div class="reply-bar-inner">
          <span class="reply-bar-label">‚Ü© Replying to <strong id="replyToName"></strong></span>
          <span class="reply-bar-preview" id="replyToPreview"></span>
          <button id="cancelReplyBtn">‚úï</button>
        </div>
      </div>

      <div id="usernameChangeBar" style="display:none;">
        <div class="username-change-inner">
          <input id="usernameChangeInput" placeholder="New username" maxlength="24">
          <span id="usernameChangeCooldown" class="cooldown-hint"></span>
          <button id="usernameChangeSaveBtn">Save</button>
          <button id="usernameChangeCancelBtn">Cancel</button>
        </div>
      </div>

      <!-- @mention autocomplete -->
      <div id="mentionDropdown" class="mention-dropdown" style="display:none;"></div>

      <div id="inputArea">
        <button id="changeUsernameBtn" class="input-icon-btn" title="Change username">‚úèÔ∏è</button>
        <input id="msgInput" placeholder="Message #general">
        <button id="sendBtn">Send</button>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
